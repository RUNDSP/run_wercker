name: rundsp
version: 0.0.2
inherits: wercker/ubuntu12.04-ruby2.0.0@1.0.0
type: service
platform: ubuntu@12.04
description: Ruby 2, Mongo 2.4.6, Redis 2.6.16, GeoIP
keywords:
  - ruby
  - geoip
  - redis
  - mongo
script: |
  sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10
  echo "deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen" | sudo tee -a /etc/apt/sources.list.d/10gen.list
  sudo apt-get -y update

  sudo apt-get remove mongodb mongodb-clients
  sudo apt-get install mongodb-10gen=2.4.6

  curl -O http://download.redis.io/releases/redis-2.6.16.tar.gz
  tar xvf redis-2.6.16.tar.gz
  cd redis-2.6.16
  make
  sudo make install
  cd ..

  curl -O http://geolite.maxmind.com/download/geoip/api/c/GeoIP-1.4.8.tar.gz
  tar -xvzf GeoIP-1.4.8.tar.gz
  cd GeoIP-1.4.8
  ./configure --prefix=/usr
  make
  sudo make install
  cd ..